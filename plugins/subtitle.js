function unescapeHTML(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function parseSrt(e){sTimeList=[],eTimeList=[],subList=[];var t=0,i=e.replace(/\r\n/g,"\n").split("\n");do{if(""==i[t])break;var s=parseTimeSpan(i[++t]);sTimeList.push(s[0]),eTimeList.push(s[1]),totalSubTime+=s[1]-s[0];var r="";t++;do{r+=i[t]+"\n",t++}while(t<i.length&&""!=i[t]);r=unescapeHTML(r),subList.push(r),t++}while(t<i.length);e.length>0&&(hasSubtitle=!0)}function parseTimeSpan(e){var t,i,s=e.split(" --\x3e ");return 1===s.length?i=(t=parseTime(s[0]))+100:(t=parseTime(s[0]),i=parseTime(s[1])),[t,i]}function parseTime(e){var t=e.replace(".",",").split(","),i=t[0].split(":");return new Date(0,0,0,parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(t[1])).getTime()}function isInSub(e,t){for(var i=ref+1e3*e,s=0;s<sTimeList.length;s++)if(sTimeList[s]-t<=i&&i<eTimeList[s])return!0;return!1}function isInWhichSub(e,t){for(var i=ref+1e3*e,s=0;s<sTimeList.length;s++)if(sTimeList[s]-t<=i&&i<eTimeList[s])return s;return-1}function getNewDuration(e,t,i,s){for(var r=!0,n=[],a=[],l=0;l<sTimeList.length;l++)a.push(sTimeList[l]),n.push(eTimeList[l]),1!=r?i>sTimeList[l]-eTimeList[l-1]?(a.push(eTimeList[l-1]),n.push(sTimeList[l])):(a.push(sTimeList[l]-i),n.push(sTimeList[l])):r=!1;for(var u=0,l=0;l<a.length;l++)u+=n[l]-a[l];var p=u/t+(s-u)/e,o=(s-p)/1e3,c=p/s*100,m=6e4*new Date(0).getTimezoneOffset();return[p,o,c,new Date(m+p)]}function getSubFromUrl(e,t){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status?(parseSrt(i.responseText),t(!1)):t(!0)},i.open("GET",e),i.send(null)}function shiftBackSubtitles(e){for(var t=0;t<sTimeList.length;t++)sTimeList[t]-=e,eTimeList[t]-=e}window.File&&window.FileReader&&window.FileList&&window.Blob||alert("The File APIs are not fully supported in this browser.");var getUrlVars=function(){for(var e={},t=location.search.substring(1).split("&"),i=0;i<t.length;i++){var s=t[i].search(/=/),r="";-1!=s&&(r=t[i].slice(0,s));var n=t[i].slice(t[i].indexOf("=",0)+1);""!=r&&(e[r]=decodeURIComponent(n))}return e},hasSubtitle=!1,sTimeList=[],eTimeList=[],subList=[],totalSubTime=0,ref=new Date(0,0,0,0,0,0,0).getTime(),formatDate=function(e,t){if(t||(t="YYYY-MM-DD hh:mm:ss.SSS"),t=t.replace(/YYYY/g,e.getFullYear()),t=t.replace(/MM/g,("0"+(e.getMonth()+1)).slice(-2)),t=t.replace(/DD/g,("0"+e.getDate()).slice(-2)),t=t.replace(/hh/g,("0"+e.getHours()).slice(-2)),t=t.replace(/mm/g,("0"+e.getMinutes()).slice(-2)),(t=t.replace(/ss/g,("0"+e.getSeconds()).slice(-2))).match(/S/g))for(var i=("00"+e.getMilliseconds()).slice(-3),s=t.match(/S/g).length,r=0;r<s;r++)t=t.replace(/S/,i.substring(r,r+1));return t};