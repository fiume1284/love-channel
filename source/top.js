"use strict";

var channelId;
var channelIconUrl;

$(function () {
  var firebaseConfig = {
    apiKey: "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw",
    authDomain: "youtube-view-counter-b55c2.firebaseapp.com",
    databaseURL: "https://youtube-view-counter-b55c2.firebaseio.com",
    projectId: "youtube-view-counter-b55c2",
    storageBucket: "youtube-view-counter-b55c2.appspot.com",
    messagingSenderId: "375316669656"
  };
  firebase.initializeApp(firebaseConfig);

  var ref = firebase.database().ref("channel_icons/html");
  ref.on("value", function (snapshot) {
    $("#output").html(snapshot.A.B);
  });

  var videoId = getVideoIdFromUrl();
  var channelIconUrl = searchChannelIconFromVideoId(videoId);

  searchRelatedVideoFromVideoId(videoId);
});

/**
 * 動画IDを返す
 */
function getVideoIdFromUrl() {
  var videoId = "jNQXAC9IVRw"; // YouTube最古の動画
  var urlQueries = getUrlVars(); // 注意： getUrlVars は subtitle.js のメソッド
  if (urlQueries["v"]) {
    videoId = urlQueries["v"];
  }

  return videoId;
}

/**
 * 動画IDを基にチャンネルアイコンのURLを返す
 */
function searchChannelIconFromVideoId(videoId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";

  $.get("https://www.googleapis.com/youtube/v3/videos?part=snippet&id=" + videoId + "&key=" + apiKey, function (data) {
    channelId = data["items"][0]["snippet"]["channelId"];
    console.log("channelId = " + channelId);

    return searchChannelIconFromChannelId(channelId);
  });
}

/**
 * チャンネルIDを基にチャンネルアイコンのURLを返す
 */
function searchChannelIconFromChannelId(channelId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";

  $.get("https://www.googleapis.com/youtube/v3/channels?part=snippet&id=" + channelId + "&key=" + apiKey, function (data) {
    channelIconUrl = data["items"][0]["snippet"]["thumbnails"]["default"]["url"];
    console.log("channelIconUrl = " + channelIconUrl);

    return channelIconUrl;
  });
}

/**
 * 関連動画を検索し、その一覧をページに出力
 */
function searchRelatedVideoFromVideoId(videoId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";
  var maxResults = 24; // 検索ヒット数、APIのデフォルトは 5, 最大値は 50

  var requestUrl = "https://www.googleapis.com/youtube/v3/search?part=snippet&type=video";
  requestUrl += "&maxResults=" + maxResults;
  requestUrl += "&relatedToVideoId=" + videoId;
  requestUrl += "&key=" + apiKey;

  $.get(requestUrl, function (data) {
    $("#next-video").html("");

    var items = data["items"];
    for (var i = 0; i < items.length; ++i) {
      var relatedVideoTitle = items[i]["snippet"]["title"];
      var relatedVideoId = items[i]["id"]["videoId"];
      var relatedVideoChannelId = items[i]["snippet"]["channelId"];

      // 関連動画で違うチャンネルIDのものはわかりやすいように色を変える
      var buttonStyle = "btn-primary";
      if (channelId !== undefined && channelId !== relatedVideoChannelId) {
        buttonStyle = "btn-warning";
      }

      $("#next-video").append('<row>\
          <div class="col-sm-12">\
            <a class="btn ' + buttonStyle + '" \
            href="' + getCurrentUrlBase() + '?surl=5seconds.srt&autoplay=1&v=' + relatedVideoId + '">' + relatedVideoTitle + '</a>\
          </div>\
        </row>');
    }
  });
}

/**
 * 現在のページから、クエリ・ハッシュ部分を除いたURLを取得
 * @return String http://a.com/xxx/ のような値が返る
 */
function getCurrentUrlBase() {
  var baseUrl = location.protocol + "//" + location.host + location.pathname;

  return baseUrl;
}

/**
 * 出力部分に、動画のチャンネルアイコンを足す。データベース側も更新
 */
function addIcon() {
  $("#output").append("<img src=\"" + channelIconUrl + "\">");

  firebase.database().ref("channel_icons").set({
    html: $("#output").html()
  });
}

/**
 * 出力エリアのすべてのアイコンとDBデータを削除
 */
function removeAllIcons() {
  if (confirm("本当に削除してよろしいですか？") === true) {
    $("#output").html("");

    firebase.database().ref("channel_icons").remove();
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvcC5lczYiXSwibmFtZXMiOlsiY2hhbm5lbElkIiwiY2hhbm5lbEljb25VcmwiLCIkIiwiZmlyZWJhc2VDb25maWciLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwiZGF0YWJhc2VVUkwiLCJwcm9qZWN0SWQiLCJzdG9yYWdlQnVja2V0IiwibWVzc2FnaW5nU2VuZGVySWQiLCJmaXJlYmFzZSIsImluaXRpYWxpemVBcHAiLCJyZWYiLCJkYXRhYmFzZSIsIm9uIiwic25hcHNob3QiLCJodG1sIiwiQSIsIkIiLCJ2aWRlb0lkIiwiZ2V0VmlkZW9JZEZyb21VcmwiLCJzZWFyY2hDaGFubmVsSWNvbkZyb21WaWRlb0lkIiwic2VhcmNoUmVsYXRlZFZpZGVvRnJvbVZpZGVvSWQiLCJ1cmxRdWVyaWVzIiwiZ2V0VXJsVmFycyIsImdldCIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwic2VhcmNoQ2hhbm5lbEljb25Gcm9tQ2hhbm5lbElkIiwibWF4UmVzdWx0cyIsInJlcXVlc3RVcmwiLCJpdGVtcyIsImkiLCJsZW5ndGgiLCJyZWxhdGVkVmlkZW9UaXRsZSIsInJlbGF0ZWRWaWRlb0lkIiwicmVsYXRlZFZpZGVvQ2hhbm5lbElkIiwiYnV0dG9uU3R5bGUiLCJ1bmRlZmluZWQiLCJhcHBlbmQiLCJnZXRDdXJyZW50VXJsQmFzZSIsImJhc2VVcmwiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiaG9zdCIsInBhdGhuYW1lIiwiYWRkSWNvbiIsInNldCIsInJlbW92ZUFsbEljb25zIiwiY29uZmlybSIsInJlbW92ZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxTQUFKO0FBQ0EsSUFBSUMsY0FBSjs7QUFFQUMsRUFBRSxZQUFXO0FBQ1gsTUFBSUMsaUJBQWlCO0FBQ25CQyxZQUFRLHlDQURXO0FBRW5CQyxnQkFBWSw0Q0FGTztBQUduQkMsaUJBQWEsbURBSE07QUFJbkJDLGVBQVcsNEJBSlE7QUFLbkJDLG1CQUFlLHdDQUxJO0FBTW5CQyx1QkFBbUI7QUFOQSxHQUFyQjtB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cEMsUUFBRSxhQUFGLEVBQWlCc0MsTUFBakIsQ0FDRTs7MkJBQUEsR0FFc0JGLFdBRnRCLEdBRW9DO21CQUZwQyxHQUdjRyxtQkFIZCxHQUdvQyxrQ0FIcEMsR0FHeUVMLGNBSHpFLEdBRzBGLElBSDFGLEdBR2lHRCxpQkFIakcsR0FHcUg7O2VBSnZIO0FBUUQ7QUFDRixHQXhCRDtBQXlCRDs7QUFFRDs7OztBQUlBLFNBQVNNLGlCQUFULEdBQTZCO0FBQzNCLE1BQUlDLFVBQVVDLFNBQVNDLFFBQVQsR0FBb0IsSUFBcEIsR0FBMkJELFNBQVNFLElBQXBDLEdBQTJDRixTQUFTRyxRQUFsRTs7QUFFQSxTQUFPSixPQUFQO0FBQ0Q7O0FBRUQ7OztBQUdBLFNBQVNLLE9BQVQsR0FBbUI7QUFDakI3QyxJQUFFLFNBQUYsRUFBYXNDLE1BQWIsQ0FBb0IsZ0JBQWdCdkMsY0FBaEIsR0FBaUMsS0FBckQ7O0FBRUFTLFdBQVNHLFFBQVQsR0FBb0JELEdBQXBCLENBQXdCLGVBQXhCLEVBQXlDb0MsR0FBekMsQ0FBNkM7QUFDM0NoQyxVQUFNZCxFQUFFLFNBQUYsRUFBYWMsSUFBYjtBQURxQyxHQUE3QztBQUdEOztBQUVEOzs7QUFHQSxTQUFTaUMsY0FBVCxHQUEwQjtBQUN4QixNQUFHQyxRQUFRLGlCQUFSLE1BQStCLElBQWxDLEVBQXdDO0FBQ3RDaEQsTUFBRSxTQUFGLEVBQWFjLElBQWIsQ0FBa0IsRUFBbEI7O0FBRUFOLGFBQVNHLFFBQVQsR0FBb0JELEdBQXBCLENBQXdCLGVBQXhCLEVBQXlDdUMsTUFBekM7QUFDRDtBQUNGIiwiZmlsZSI6InRvcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBjaGFubmVsSWQ7XG52YXIgY2hhbm5lbEljb25Vcmw7XG5cbiQoZnVuY3Rpb24oKSB7XG4gIHZhciBmaXJlYmFzZUNvbmZpZyA9IHtcbiAgICBhcGlLZXk6IFwiQUl6YVN5QlYtVG9xdGwxa3pYeVkxcm9lUVpvZUxFM2ZCVGdfM1l3XCIsXG4gICAgYXV0aERvbWFpbjogXCJ5b3V0dWJlLXZpZXctY291bnRlci1iNTVjMi5maXJlYmFzZWFwcC5jb21cIixcbiAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL3lvdXR1YmUtdmlldy1jb3VudGVyLWI1NWMyLmZpcmViYXNlaW8uY29tXCIsXG4gICAgcHJvamVjdElkOiBcInlvdXR1YmUtdmlldy1jb3VudGVyLWI1NWMyXCIsXG4gICAgc3RvcmFnZUJ1Y2tldDogXCJ5b3V0dWJlLXZpZXctY291bnRlci1iNTVjMi5hcHBzcG90LmNvbVwiLFxuICAgIG1lc3NhZ2luZ1NlbmRlcklkOiBcIjM3NTMxNjY2OTY1NlwiXG4gIH07XG4gIGZpcmViYXNlLmluaXRpYWxpemVBcHAoZmlyZWJhc2VDb25maWcpO1xuXG4gIHZhciByZWYgPSBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihcImNoYW5uZWxfaWNvbnMvaHRtbFwiKTtcbiAgcmVmLm9uKFwidmFsdWVcIiwgZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAkKFwiI291dHB1dFwiKS5odG1sKHNuYXBzaG90LkEuQik7XG4gIH0pO1xuXG4gIHZhciB2aWRlb0lkID0gZ2V0VmlkZW9JZEZyb21VcmwoKTtcbiAgdmFyIGNoYW5uZWxJY29uVXJsID0gc2VhcmNoQ2hhbm5lbEljb25Gcm9tVmlkZW9JZCh2aWRlb0lkKTtcblxuICBzZWFyY2hSZWxhdGVkVmlkZW9Gcm9tVmlkZW9JZCh2aWRlb0lkKTtcbn0pO1xuXG4vKipcbiAqIOWLleeUu0lE44KS6L+U44GZXG4gKi9cbmZ1bmN0aW9uIGdldFZpZGVvSWRGcm9tVXJsKCkge1xuICB2YXIgdmlkZW9JZCA9IFwiak5RWEFDOUlWUndcIiAvLyBZb3VUdWJl5pyA5Y+k44Gu5YuV55S7XG4gIHZhciB1cmxRdWVyaWVzID0gZ2V0VXJsVmFycygpOyAvLyDms6jmhI/vvJogZ2V0VXJsVmFycyDjga8gc3VidGl0bGUuanMg44Gu44Oh44K944OD44OJXG4gIGlmICh1cmxRdWVyaWVzW1widlwiXSkge1xuICAgIHZpZGVvSWQgPSB1cmxRdWVyaWVzW1widlwiXTtcbiAgfVxuXG4gIHJldHVybiB2aWRlb0lkO1xufVxuXG4vKipcbiAqIOWLleeUu0lE44KS5Z+644Gr44OB44Oj44Oz44ON44Or44Ki44Kk44Kz44Oz44GuVVJM44KS6L+U44GZXG4gKi9cbmZ1bmN0aW9uIHNlYXJjaENoYW5uZWxJY29uRnJvbVZpZGVvSWQodmlkZW9JZCkge1xuICBjb25zdCBhcGlLZXkgPSBcIkFJemFTeUJWLVRvcXRsMWt6WHlZMXJvZVFab2VMRTNmQlRnXzNZd1wiO1xuXG4gICQuZ2V0KFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20veW91dHViZS92My92aWRlb3M/cGFydD1zbmlwcGV0JmlkPVwiICsgdmlkZW9JZCArIFwiJmtleT1cIiArIGFwaUtleSwgZnVuY3Rpb24oZGF0YSkge1xuICAgIGNoYW5uZWxJZCA9IGRhdGFbXCJpdGVtc1wiXVswXVtcInNuaXBwZXRcIl1bXCJjaGFubmVsSWRcIl07XG4gICAgY29uc29sZS5sb2coXCJjaGFubmVsSWQgPSBcIiArIGNoYW5uZWxJZCk7XG5cbiAgICByZXR1cm4gc2VhcmNoQ2hhbm5lbEljb25Gcm9tQ2hhbm5lbElkKGNoYW5uZWxJZCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOODgeODo+ODs+ODjeODq0lE44KS5Z+644Gr44OB44Oj44Oz44ON44Or44Ki44Kk44Kz44Oz44GuVVJM44KS6L+U44GZXG4gKi9cbmZ1bmN0aW9uIHNlYXJjaENoYW5uZWxJY29uRnJvbUNoYW5uZWxJZChjaGFubmVsSWQpIHtcbiAgY29uc3QgYXBpS2V5ID0gXCJBSXphU3lCVi1Ub3F0bDFrelh5WTFyb2VRWm9lTEUzZkJUZ18zWXdcIjtcblxuICAkLmdldChcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3lvdXR1YmUvdjMvY2hhbm5lbHM/cGFydD1zbmlwcGV0JmlkPVwiICsgY2hhbm5lbElkICsgXCIma2V5PVwiICsgYXBpS2V5LCBmdW5jdGlvbihkYXRhKSB7XG4gICAgY2hhbm5lbEljb25VcmwgPSBkYXRhW1wiaXRlbXNcIl1bMF1bXCJzbmlwcGV0XCJdW1widGh1bWJuYWlsc1wiXVtcImRlZmF1bHRcIl1bXCJ1cmxcIl07XG4gICAgY29uc29sZS5sb2coXCJjaGFubmVsSWNvblVybCA9IFwiICsgY2hhbm5lbEljb25VcmwpO1xuXG4gICAgcmV0dXJuIGNoYW5uZWxJY29uVXJsO1xuICB9KTtcbn1cblxuLyoqXG4gKiDplqLpgKPli5XnlLvjgpLmpJzntKLjgZfjgIHjgZ3jga7kuIDopqfjgpLjg5rjg7zjgrjjgavlh7rliptcbiAqL1xuZnVuY3Rpb24gc2VhcmNoUmVsYXRlZFZpZGVvRnJvbVZpZGVvSWQodmlkZW9JZCkge1xuICBjb25zdCBhcGlLZXkgPSBcIkFJemFTeUJWLVRvcXRsMWt6WHlZMXJvZVFab2VMRTNmQlRnXzNZd1wiO1xuICBjb25zdCBtYXhSZXN1bHRzID0gMjQ7IC8vIOaknOe0ouODkuODg+ODiOaVsOOAgUFQSeOBruODh+ODleOCqeODq+ODiOOBryA1LCDmnIDlpKflgKTjga8gNTBcblxuICB2YXIgcmVxdWVzdFVybCA9IFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20veW91dHViZS92My9zZWFyY2g/cGFydD1zbmlwcGV0JnR5cGU9dmlkZW9cIjtcbiAgcmVxdWVzdFVybCArPSBcIiZtYXhSZXN1bHRzPVwiICsgbWF4UmVzdWx0cztcbiAgcmVxdWVzdFVybCArPSBcIiZyZWxhdGVkVG9WaWRlb0lkPVwiICsgdmlkZW9JZDtcbiAgcmVxdWVzdFVybCArPSBcIiZrZXk9XCIgKyBhcGlLZXk7XG5cbiAgJC5nZXQocmVxdWVzdFVybCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICQoXCIjbmV4dC12aWRlb1wiKS5odG1sKFwiXCIpO1xuXG4gICAgdmFyIGl0ZW1zID0gZGF0YVtcIml0ZW1zXCJdO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7ICsraSkge1xuICAgICAgdmFyIHJlbGF0ZWRWaWRlb1RpdGxlID0gaXRlbXNbaV1bXCJzbmlwcGV0XCJdW1widGl0bGVcIl07XG4gICAgICB2YXIgcmVsYXRlZFZpZGVvSWQgPSBpdGVtc1tpXVtcImlkXCJdW1widmlkZW9JZFwiXTtcbiAgICAgIHZhciByZWxhdGVkVmlkZW9DaGFubmVsSWQgPSBpdGVtc1tpXVtcInNuaXBwZXRcIl1bXCJjaGFubmVsSWRcIl07XG5cbiAgICAgIC8vIOmWoumAo+WLleeUu+OBp+mBleOBhuODgeODo+ODs+ODjeODq0lE44Gu44KC44Gu44Gv44KP44GL44KK44KE44GZ44GE44KI44GG44Gr6Imy44KS5aSJ44GI44KLXG4gICAgICB2YXIgYnV0dG9uU3R5bGUgPSBcImJ0bi1wcmltYXJ5XCI7XG4gICAgICBpZiAoY2hhbm5lbElkICE9PSB1bmRlZmluZWQgJiYgY2hhbm5lbElkICE9PSByZWxhdGVkVmlkZW9DaGFubmVsSWQpIHtcbiAgICAgICAgYnV0dG9uU3R5bGUgPSBcImJ0bi13YXJuaW5nXCI7XG4gICAgICB9XG5cbiAgICAgICQoXCIjbmV4dC12aWRlb1wiKS5hcHBlbmQoXG4gICAgICAgICc8cm93PlxcXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS0xMlwiPlxcXG4gICAgICAgICAgICA8YSBjbGFzcz1cImJ0biAnICsgYnV0dG9uU3R5bGUgKyAnXCIgXFxcbiAgICAgICAgICAgIGhyZWY9XCInICsgZ2V0Q3VycmVudFVybEJhc2UoKSArICc/c3VybD01c2Vjb25kcy5zcnQmYXV0b3BsYXk9MSZ2PScgKyByZWxhdGVkVmlkZW9JZCArICdcIj4nICsgcmVsYXRlZFZpZGVvVGl0bGUgKyAnPC9hPlxcXG4gICAgICAgICAgPC9kaXY+XFxcbiAgICAgICAgPC9yb3c+J1xuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOePvuWcqOOBruODmuODvOOCuOOBi+OCieOAgeOCr+OCqOODquODu+ODj+ODg+OCt+ODpemDqOWIhuOCkumZpOOBhOOBn1VSTOOCkuWPluW+l1xuICogQHJldHVybiBTdHJpbmcgaHR0cDovL2EuY29tL3h4eC8g44Gu44KI44GG44Gq5YCk44GM6L+U44KLXG4gKi9cbmZ1bmN0aW9uIGdldEN1cnJlbnRVcmxCYXNlKCkge1xuICB2YXIgYmFzZVVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lO1xuXG4gIHJldHVybiBiYXNlVXJsO1xufVxuXG4vKipcbiAqIOWHuuWKm+mDqOWIhuOBq+OAgeWLleeUu+OBruODgeODo+ODs+ODjeODq+OCouOCpOOCs+ODs+OCkui2s+OBmeOAguODh+ODvOOCv+ODmeODvOOCueWBtOOCguabtOaWsFxuICovXG5mdW5jdGlvbiBhZGRJY29uKCkge1xuICAkKFwiI291dHB1dFwiKS5hcHBlbmQoXCI8aW1nIHNyYz1cXFwiXCIgKyBjaGFubmVsSWNvblVybCArIFwiXFxcIj5cIik7XG5cbiAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoXCJjaGFubmVsX2ljb25zXCIpLnNldCh7XG4gICAgaHRtbDogJChcIiNvdXRwdXRcIikuaHRtbCgpXG4gIH0pO1xufVxuXG4vKipcbiAqIOWHuuWKm+OCqOODquOCouOBruOBmeOBueOBpuOBruOCouOCpOOCs+ODs+OBqERC44OH44O844K/44KS5YmK6ZmkXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUFsbEljb25zKCkge1xuICBpZihjb25maXJtKFwi5pys5b2T44Gr5YmK6Zmk44GX44Gm44KI44KN44GX44GE44Gn44GZ44GL77yfXCIpID09PSB0cnVlKSB7XG4gICAgJChcIiNvdXRwdXRcIikuaHRtbChcIlwiKTtcblxuICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKFwiY2hhbm5lbF9pY29uc1wiKS5yZW1vdmUoKTtcbiAgfVxufVxuIl19
