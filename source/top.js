"use strict";

var channelId;
var channelIconUrl;

$(function () {
  var firebaseConfig = {
    apiKey: "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw",
    authDomain: "youtube-view-counter-b55c2.firebaseapp.com",
    databaseURL: "https://youtube-view-counter-b55c2.firebaseio.com",
    projectId: "youtube-view-counter-b55c2",
    storageBucket: "youtube-view-counter-b55c2.appspot.com",
    messagingSenderId: "375316669656"
  };
  firebase.initializeApp(firebaseConfig);

  var ref = firebase.database().ref("channel_icons/html");
  ref.on("value", function (snapshot) {
    $("#output").html(snapshot.A.B);
  });

  var videoId = getVideoIdFromUrl();
  var channelIconUrl = searchChannelIconFromVideoId(videoId);

  searchRelatedVideoFromVideoId(videoId);
});

/**
 * 動画IDを返す
 */
function getVideoIdFromUrl() {
  var videoId = "jNQXAC9IVRw"; // YouTube最古の動画
  var urlQueries = getUrlVars(); // 注意： getUrlVars は subtitle.js のメソッド
  if (urlQueries["v"]) {
    videoId = urlQueries["v"];
  }

  return videoId;
}

/**
 * 動画IDを基にチャンネルアイコンのURLを返す
 */
function searchChannelIconFromVideoId(videoId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";

  $.get("https://www.googleapis.com/youtube/v3/videos?part=snippet&id=" + videoId + "&key=" + apiKey, function (data) {
    channelId = data["items"][0]["snippet"]["channelId"];
    console.log("channelId = " + channelId);

    return searchChannelIconFromChannelId(channelId);
  });
}

/**
 * チャンネルIDを基にチャンネルアイコンのURLを返す
 */
function searchChannelIconFromChannelId(channelId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";

  $.get("https://www.googleapis.com/youtube/v3/channels?part=snippet&id=" + channelId + "&key=" + apiKey, function (data) {
    channelIconUrl = data["items"][0]["snippet"]["thumbnails"]["default"]["url"];
    console.log("channelIconUrl = " + channelIconUrl);

    return channelIconUrl;
  });
}

/**
 * 関連動画を検索し、その一覧をページに出力
 */
function searchRelatedVideoFromVideoId(videoId) {
  var apiKey = "AIzaSyBV-Toqtl1kzXyY1roeQZoeLE3fBTg_3Yw";
  var maxResults = 12; // 検索ヒット数、APIのデフォルトは 5, 最大値は 50

  var requestUrl = "https://www.googleapis.com/youtube/v3/search?part=snippet&type=video";
  requestUrl += "&maxResults=" + maxResults;
  requestUrl += "&relatedToVideoId=" + videoId;
  requestUrl += "&key=" + apiKey;

  $.get(requestUrl, function (data) {
    $("#next-video").html("");

    var items = data["items"];
    for (var i = 0; i < items.length; ++i) {
      var relatedVideoTitle = items[i]["snippet"]["title"];
      var relatedVideoId = items[i]["id"]["videoId"];

      $("#next-video").append('<row>\
          <div class="col-sm-12">\
            <a class="btn btn-primary" \
            href="' + getCurrentUrlBase() + '?surl=5seconds.srt&autoplay=1&v=' + relatedVideoId + '">' + relatedVideoTitle + '</a>\
          </div>\
        </row>');
    }
  });
}

/**
 * 現在のページから、クエリ・ハッシュ部分を除いたURLを取得
 * @return String http://a.com/xxx/ のような値が返る
 */
function getCurrentUrlBase() {
  var baseUrl = location.protocol + "//" + location.host + location.pathname;

  return baseUrl;
}

/**
 * 出力部分に、動画のチャンネルアイコンを足す。データベース側も更新
 */
function addIcon() {
  $("#output").append("<img src=\"" + channelIconUrl + "\">");

  firebase.database().ref("channel_icons").set({
    html: $("#output").html()
  });
}

/**
 * 出力エリアのすべてのアイコンとDBデータを削除
 */
function removeAllIcons() {
  if (confirm("本当に削除してよろしいですか？") === true) {
    $("#output").html("");

    firebase.database().ref("channel_icons").remove();
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvcC5lczYiXSwibmFtZXMiOlsiY2hhbm5lbElkIiwiY2hhbm5lbEljb25VcmwiLCIkIiwiZmlyZWJhc2VDb25maWciLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwiZGF0YWJhc2VVUkwiLCJwcm9qZWN0SWQiLCJzdG9yYWdlQnVja2V0IiwibWVzc2FnaW5nU2VuZGVySWQiLCJmaXJlYmFzZSIsImluaXRpYWxpemVBcHAiLCJyZWYiLCJkYXRhYmFzZSIsIm9uIiwic25hcHNob3QiLCJodG1sIiwiQSIsIkIiLCJ2aWRlb0lkIiwiZ2V0VmlkZW9JZEZyb21VcmwiLCJzZWFyY2hDaGFubmVsSWNvbkZyb21WaWRlb0lkIiwic2VhcmNoUmVsYXRlZFZpZGVvRnJvbVZpZGVvSWQiLCJ1cmxRdWVyaWVzIiwiZ2V0VXJsVmFycyIsImdldCIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwic2VhcmNoQ2hhbm5lbEljb25Gcm9tQ2hhbm5lbElkIiwibWF4UmVzdWx0cyIsInJlcXVlc3RVcmwiLCJpdGVtcyIsImkiLCJsZW5ndGgiLCJyZWxhdGVkVmlkZW9UaXRsZSIsInJlbGF0ZWRWaWRlb0lkIiwiYXBwZW5kIiwiZ2V0Q3VycmVudFVybEJhc2UiLCJiYXNlVXJsIiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJwYXRobmFtZSIsImFkZEljb24iLCJzZXQiLCJyZW1vdmVBbGxJY29ucyIsImNvbmZpcm0iLCJyZW1vdmUiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsU0FBSjtBQUNBLElBQUlDLGNBQUo7O0FBRUFDLEVBQUUsWUFBVztBQUNYLE1BQUlDLGlCQUFpQjtBQUNuQkMsWUFBUSx5Q0FEVztBQUVuQkMsZ0JBQVksNENBRk87QUFHbkJDLGlCQUFhLG1EQUhNO0FBSW5CQyxlQUFXLDRCQUpRO0FBS25CQyxtQkFBZSx3Q0FMSTtBQU1uQkMsdUJBQW1CO0FBTkEsR0FBckI7QUFRQUMsV0FBU0MsYUFBVCxDQUF1QlIsY0FBdkI7O0FBRUEsTUFBSVMsTUFBTUYsU0FB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LEdBQTJCRCxTQUFTRSxJQUFwQyxHQUEyQ0YsU0FBU0csUUFBbEU7O0FBRUEsU0FBT0osT0FBUDtBQUNEOztBQUVEOzs7QUFHQSxTQUFTSyxPQUFULEdBQW1CO0FBQ2pCMUMsSUFBRSxTQUFGLEVBQWFtQyxNQUFiLENBQW9CLGdCQUFnQnBDLGNBQWhCLEdBQWlDLEtBQXJEOztBQUVBUyxXQUFTRyxRQUFULEdBQW9CRCxHQUFwQixDQUF3QixlQUF4QixFQUF5Q2lDLEdBQXpDLENBQTZDO0FBQzNDN0IsVUFBTWQsRUFBRSxTQUFGLEVBQWFjLElBQWI7QUFEcUMsR0FBN0M7QUFHRDs7QUFFRDs7O0FBR0EsU0FBUzhCLGNBQVQsR0FBMEI7QUFDeEIsTUFBR0MsUUFBUSxpQkFBUixNQUErQixJQUFsQyxFQUF3QztBQUN0QzdDLE1BQUUsU0FBRixFQUFhYyxJQUFiLENBQWtCLEVBQWxCOztBQUVBTixhQUFTRyxRQUFULEdBQW9CRCxHQUFwQixDQUF3QixlQUF4QixFQUF5Q29DLE1BQXpDO0FBQ0Q7QUFDRiIsImZpbGUiOiJ0b3AuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY2hhbm5lbElkO1xudmFyIGNoYW5uZWxJY29uVXJsO1xuXG4kKGZ1bmN0aW9uKCkge1xuICB2YXIgZmlyZWJhc2VDb25maWcgPSB7XG4gICAgYXBpS2V5OiBcIkFJemFTeUJWLVRvcXRsMWt6WHlZMXJvZVFab2VMRTNmQlRnXzNZd1wiLFxuICAgIGF1dGhEb21haW46IFwieW91dHViZS12aWV3LWNvdW50ZXItYjU1YzIuZmlyZWJhc2VhcHAuY29tXCIsXG4gICAgZGF0YWJhc2VVUkw6IFwiaHR0cHM6Ly95b3V0dWJlLXZpZXctY291bnRlci1iNTVjMi5maXJlYmFzZWlvLmNvbVwiLFxuICAgIHByb2plY3RJZDogXCJ5b3V0dWJlLXZpZXctY291bnRlci1iNTVjMlwiLFxuICAgIHN0b3JhZ2VCdWNrZXQ6IFwieW91dHViZS12aWV3LWNvdW50ZXItYjU1YzIuYXBwc3BvdC5jb21cIixcbiAgICBtZXNzYWdpbmdTZW5kZXJJZDogXCIzNzUzMTY2Njk2NTZcIlxuICB9O1xuICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcblxuICB2YXIgcmVmID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoXCJjaGFubmVsX2ljb25zL2h0bWxcIik7XG4gIHJlZi5vbihcInZhbHVlXCIsIGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgJChcIiNvdXRwdXRcIikuaHRtbChzbmFwc2hvdC5BLkIpO1xuICB9KTtcblxuICB2YXIgdmlkZW9JZCA9IGdldFZpZGVvSWRGcm9tVXJsKCk7XG4gIHZhciBjaGFubmVsSWNvblVybCA9IHNlYXJjaENoYW5uZWxJY29uRnJvbVZpZGVvSWQodmlkZW9JZCk7XG5cbiAgc2VhcmNoUmVsYXRlZFZpZGVvRnJvbVZpZGVvSWQodmlkZW9JZCk7XG59KTtcblxuLyoqXG4gKiDli5XnlLtJROOCkui/lOOBmVxuICovXG5mdW5jdGlvbiBnZXRWaWRlb0lkRnJvbVVybCgpIHtcbiAgdmFyIHZpZGVvSWQgPSBcImpOUVhBQzlJVlJ3XCIgLy8gWW91VHViZeacgOWPpOOBruWLleeUu1xuICB2YXIgdXJsUXVlcmllcyA9IGdldFVybFZhcnMoKTsgLy8g5rOo5oSP77yaIGdldFVybFZhcnMg44GvIHN1YnRpdGxlLmpzIOOBruODoeOCveODg+ODiVxuICBpZiAodXJsUXVlcmllc1tcInZcIl0pIHtcbiAgICB2aWRlb0lkID0gdXJsUXVlcmllc1tcInZcIl07XG4gIH1cblxuICByZXR1cm4gdmlkZW9JZDtcbn1cblxuLyoqXG4gKiDli5XnlLtJROOCkuWfuuOBq+ODgeODo+ODs+ODjeODq+OCouOCpOOCs+ODs+OBrlVSTOOCkui/lOOBmVxuICovXG5mdW5jdGlvbiBzZWFyY2hDaGFubmVsSWNvbkZyb21WaWRlb0lkKHZpZGVvSWQpIHtcbiAgY29uc3QgYXBpS2V5ID0gXCJBSXphU3lCVi1Ub3F0bDFrelh5WTFyb2VRWm9lTEUzZkJUZ18zWXdcIjtcblxuICAkLmdldChcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3lvdXR1YmUvdjMvdmlkZW9zP3BhcnQ9c25pcHBldCZpZD1cIiArIHZpZGVvSWQgKyBcIiZrZXk9XCIgKyBhcGlLZXksIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBjaGFubmVsSWQgPSBkYXRhW1wiaXRlbXNcIl1bMF1bXCJzbmlwcGV0XCJdW1wiY2hhbm5lbElkXCJdO1xuICAgIGNvbnNvbGUubG9nKFwiY2hhbm5lbElkID0gXCIgKyBjaGFubmVsSWQpO1xuXG4gICAgcmV0dXJuIHNlYXJjaENoYW5uZWxJY29uRnJvbUNoYW5uZWxJZChjaGFubmVsSWQpO1xuICB9KTtcbn1cblxuLyoqXG4gKiDjg4Hjg6Pjg7Pjg43jg6tJROOCkuWfuuOBq+ODgeODo+ODs+ODjeODq+OCouOCpOOCs+ODs+OBrlVSTOOCkui/lOOBmVxuICovXG5mdW5jdGlvbiBzZWFyY2hDaGFubmVsSWNvbkZyb21DaGFubmVsSWQoY2hhbm5lbElkKSB7XG4gIGNvbnN0IGFwaUtleSA9IFwiQUl6YVN5QlYtVG9xdGwxa3pYeVkxcm9lUVpvZUxFM2ZCVGdfM1l3XCI7XG5cbiAgJC5nZXQoXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS95b3V0dWJlL3YzL2NoYW5uZWxzP3BhcnQ9c25pcHBldCZpZD1cIiArIGNoYW5uZWxJZCArIFwiJmtleT1cIiArIGFwaUtleSwgZnVuY3Rpb24oZGF0YSkge1xuICAgIGNoYW5uZWxJY29uVXJsID0gZGF0YVtcIml0ZW1zXCJdWzBdW1wic25pcHBldFwiXVtcInRodW1ibmFpbHNcIl1bXCJkZWZhdWx0XCJdW1widXJsXCJdO1xuICAgIGNvbnNvbGUubG9nKFwiY2hhbm5lbEljb25VcmwgPSBcIiArIGNoYW5uZWxJY29uVXJsKTtcblxuICAgIHJldHVybiBjaGFubmVsSWNvblVybDtcbiAgfSk7XG59XG5cbi8qKlxuICog6Zai6YCj5YuV55S744KS5qSc57Si44GX44CB44Gd44Gu5LiA6Kan44KS44Oa44O844K444Gr5Ye65YqbXG4gKi9cbmZ1bmN0aW9uIHNlYXJjaFJlbGF0ZWRWaWRlb0Zyb21WaWRlb0lkKHZpZGVvSWQpIHtcbiAgY29uc3QgYXBpS2V5ID0gXCJBSXphU3lCVi1Ub3F0bDFrelh5WTFyb2VRWm9lTEUzZkJUZ18zWXdcIjtcbiAgY29uc3QgbWF4UmVzdWx0cyA9IDEyOyAvLyDmpJzntKLjg5Ljg4Pjg4jmlbDjgIFBUEnjga7jg4fjg5Xjgqnjg6vjg4jjga8gNSwg5pyA5aSn5YCk44GvIDUwXG5cbiAgdmFyIHJlcXVlc3RVcmwgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3lvdXR1YmUvdjMvc2VhcmNoP3BhcnQ9c25pcHBldCZ0eXBlPXZpZGVvXCI7XG4gIHJlcXVlc3RVcmwgKz0gXCImbWF4UmVzdWx0cz1cIiArIG1heFJlc3VsdHM7XG4gIHJlcXVlc3RVcmwgKz0gXCImcmVsYXRlZFRvVmlkZW9JZD1cIiArIHZpZGVvSWQ7XG4gIHJlcXVlc3RVcmwgKz0gXCIma2V5PVwiICsgYXBpS2V5O1xuXG4gICQuZ2V0KHJlcXVlc3RVcmwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAkKFwiI25leHQtdmlkZW9cIikuaHRtbChcIlwiKTtcblxuICAgIHZhciBpdGVtcyA9IGRhdGFbXCJpdGVtc1wiXTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIHZhciByZWxhdGVkVmlkZW9UaXRsZSA9IGl0ZW1zW2ldW1wic25pcHBldFwiXVtcInRpdGxlXCJdO1xuICAgICAgdmFyIHJlbGF0ZWRWaWRlb0lkID0gaXRlbXNbaV1bXCJpZFwiXVtcInZpZGVvSWRcIl07XG5cbiAgICAgICQoXCIjbmV4dC12aWRlb1wiKS5hcHBlbmQoXG4gICAgICAgICc8cm93PlxcXG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC1zbS0xMlwiPlxcXG4gICAgICAgICAgICA8YSBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIFxcXG4gICAgICAgICAgICBocmVmPVwiJyArIGdldEN1cnJlbnRVcmxCYXNlKCkgKyAnP3N1cmw9NXNlY29uZHMuc3J0JmF1dG9wbGF5PTEmdj0nICsgcmVsYXRlZFZpZGVvSWQgKyAnXCI+JyArIHJlbGF0ZWRWaWRlb1RpdGxlICsgJzwvYT5cXFxuICAgICAgICAgIDwvZGl2PlxcXG4gICAgICAgIDwvcm93PidcbiAgICAgICk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiDnj77lnKjjga7jg5rjg7zjgrjjgYvjgonjgIHjgq/jgqjjg6rjg7vjg4/jg4Pjgrfjg6Xpg6jliIbjgpLpmaTjgYTjgZ9VUkzjgpLlj5blvpdcbiAqIEByZXR1cm4gU3RyaW5nIGh0dHA6Ly9hLmNvbS94eHgvIOOBruOCiOOBhuOBquWApOOBjOi/lOOCi1xuICovXG5mdW5jdGlvbiBnZXRDdXJyZW50VXJsQmFzZSgpIHtcbiAgdmFyIGJhc2VVcmwgPSBsb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZTtcblxuICByZXR1cm4gYmFzZVVybDtcbn1cblxuLyoqXG4gKiDlh7rlipvpg6jliIbjgavjgIHli5XnlLvjga7jg4Hjg6Pjg7Pjg43jg6vjgqLjgqTjgrPjg7PjgpLotrPjgZnjgILjg4fjg7zjgr/jg5njg7zjgrnlgbTjgoLmm7TmlrBcbiAqL1xuZnVuY3Rpb24gYWRkSWNvbigpIHtcbiAgJChcIiNvdXRwdXRcIikuYXBwZW5kKFwiPGltZyBzcmM9XFxcIlwiICsgY2hhbm5lbEljb25VcmwgKyBcIlxcXCI+XCIpO1xuXG4gIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKFwiY2hhbm5lbF9pY29uc1wiKS5zZXQoe1xuICAgIGh0bWw6ICQoXCIjb3V0cHV0XCIpLmh0bWwoKVxuICB9KTtcbn1cblxuLyoqXG4gKiDlh7rlipvjgqjjg6rjgqLjga7jgZnjgbnjgabjga7jgqLjgqTjgrPjg7PjgahEQuODh+ODvOOCv+OCkuWJiumZpFxuICovXG5mdW5jdGlvbiByZW1vdmVBbGxJY29ucygpIHtcbiAgaWYoY29uZmlybShcIuacrOW9k+OBq+WJiumZpOOBl+OBpuOCiOOCjeOBl+OBhOOBp+OBmeOBi++8n1wiKSA9PT0gdHJ1ZSkge1xuICAgICQoXCIjb3V0cHV0XCIpLmh0bWwoXCJcIik7XG5cbiAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihcImNoYW5uZWxfaWNvbnNcIikucmVtb3ZlKCk7XG4gIH1cbn1cbiJdfQ==
